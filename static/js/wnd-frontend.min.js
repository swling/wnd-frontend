function wnd_get_query_param(a){let e=new URLSearchParams(window.location.search);return e.get(a)}function getCookie(a){return document.cookie.length>0&&(c_start=document.cookie.indexOf(a+"="),-1!=c_start)&&(c_start=c_start+a.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end)))}function setCookie(a,e,t,n="/"){if(t=t?1e3*t:0,!t)return!1;var s="",d=new Date;d.setTime(d.getTime()+t),s="; expires="+d.toGMTString(),document.cookie=a+"="+escape(e)+s+"; path="+n}function wnd_is_mobile(){return!!navigator.userAgent.match(/(iPhone|iPad|iPod|Android|ios|App\/)/i)}function wnd_is_spider(){var a=navigator.userAgent;return!!a.match(/(Googlebot|Baiduspider|spider)/i)}function wnd_send_countdown(){wait>0?($(".send-code").text(wait),wait--,send_countdown=setTimeout(wnd_send_countdown,1e3)):($(".send-code").text(wnd.msg.try_again).prop("disabled",!1).fadeTo("slow",1),wait=90)}function wnd_alert_modal(a,e=!1){wnd_reset_modal(),e?$(".modal").addClass("is-active wnd-gallery"):($(".modal").addClass("is-active"),$(".modal-entry").addClass("box")),$(".modal-entry").html(a)}function wnd_alert_warning(a){wnd_alert_modal('<div class="has-text-danger"><span class="icon"><i class="fa fa-exclamation-triangle"></i></span>'+a+"</div>")}function wnd_alert_msg(a,e=0){wnd_reset_modal(),$(".modal").addClass("is-active"),$(".modal-entry").removeClass("box"),$(".modal-entry").html('<div class="alert-message has-text-white has-text-centered">'+a+"</div>"),e>0&&(ajax_alert_time_out=setTimeout(function(){wnd_reset_modal()},1e3*e))}function wnd_ajax_msg(a,e="is-danger",t="body",n=0){$(t+" .ajax-message:first").html('<div class="message '+e+'"><div class="message-body">'+a+"</div></div>"),n>0&&(ajax_msg_time_out=setTimeout(function(){$(t+" .ajax-message:first").empty()},1e3*n))}function wnd_reset_modal(){clearTimeout(ajax_msg_time_out),clearTimeout(ajax_alert_time_out),clearTimeout(send_countdown),$("#modal").length?($("#modal").removeClass("is-active wnd-gallery"),$("#modal .modal-entry").removeClass("box"),$("#modal .modal-entry").empty()):$("body").append('<div id="modal" class="modal"><div class="modal-background"></div><div class="modal-content"><div class="modal-entry content"></div></div><button class="modal-close is-large" aria-label="close"></button></div>')}function wnd_click(a){$(a).trigger("click")}function wnd_confirm_form_submit(a,e=""){wnd_alert_modal("<p>"+e+'</p><div class="field is-grouped is-grouped-centered"><div class="control"><button class="button is-dark"  onclick="wnd_ajax_submit(\''+a+"')\" >"+wnd.msg.confirm+"</button></div></div>")}function wnd_ajax_modal(a,e=""){$.ajax({type:"GET",url:wnd_interface_api,data:{module:a,param:e,ajax_type:"modal"},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce),wnd_alert_msg("……")},success:function(a){wnd_reset_modal(),"object"==typeof a?wnd_alert_msg(a.msg):wnd_alert_modal(a)},error:function(){wnd_alert_msg(wnd.msg.system_error)}})}function wnd_ajax_embed(a,e,t=0){$.ajax({type:"GET",url:wnd_interface_api,data:{module:e,param:t,ajax_type:"embed"},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce)},success:function(e){wnd_reset_modal(),"object"==typeof e?wnd_alert_msg(e.msg):$(a).html(e)},error:function(){wnd_alert_msg(wnd.msg.system_error)}})}function wnd_ajax_submit(a){var e=$("#"+a+" [type='submit']"),t=!!$("#"+a).parents(".modal.is-active").length,n=!0;$("#"+a+" input").each(function(){$(this).prop("required")&&(""==$(this).val()&&(n=!1,$(this).addClass("is-danger")),"radio"!=$(this).attr("type")&&"checkbox"!=$(this).attr("type")||$("[name="+$(this).attr("name")+"]:checked").length<=0&&(n=!1,$(this).addClass("is-danger")))});var s=!0;$("#"+a+" select option:selected").each(function(){if(s=$(this).val(),$(this).parent().prop("required")&&"-1"==s)return s=!1,$("#"+a+" select").addClass("is-danger"),!1});var d=!0;if($("#"+a+" textarea").each(function(){$(this).prop("required")&&""==$(this).val()&&(d=!1,$(this).addClass("is-danger"))}),!1===n||!1===s||!1===d)return t?wnd_ajax_msg(wnd.msg.required,"is-danger","#"+a):wnd_alert_warning(wnd.msg.required),!1;if($(".wp-editor-area").length>0){var i,r=$(".wp-editor-area").attr("id"),o=tinyMCE.get(r);i=o?o.getContent():$("#"+r).val(),$("#"+r).val(i)}var l=new FormData($("#"+a).get(0));$.ajax({url:wnd_rest_api,dataType:"json",cache:!1,contentType:!1,processData:!1,data:l,type:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce),e.addClass("is-loading")},success:function(n){e.removeClass("is-loading"),0!=n.status&&e.prop("disabled",!0);var s=n.status>0?wnd.msg.submit_successfully:wnd.msg.submit_failed;e.text(s);var d=n.status>0?"is-success":"is-danger";switch(n.status){case 1:wnd_ajax_msg(n.msg,d,"#"+a);break;case 2:wnd_ajax_msg(wnd.msg.submit_successfully+'<a href="'+n.data.url+'" target="_blank">&nbsp;'+wnd.msg.view+"</a>",d,"#"+a);break;case 3:wnd_ajax_msg(wnd.msg.waiting,d,"#"+a),$(window.location).prop("href",n.data.redirect_to);break;case 4:wnd_reset_modal(),window.location.reload(!0);break;case 5:wnd_alert_msg(n.msg,1);break;case 6:wnd_ajax_msg(wnd.msg.downloading,d,"#"+a,5),$(window.location).prop("href",n.data.redirect_to);break;default:t?wnd_ajax_msg(n.msg,d,"#"+a):wnd_alert_msg('<div class="message '+d+'"><div class="message-body">'+n.msg+"</div></div>")}},error:function(){wnd_ajax_msg(wnd.msg.system_error,"is-danger","#"+a),e.removeClass("is-loading"),e.text(wnd.msg.system_error),e.prop("disabled",!0)}})}function wnd_ajax_update_views(a,e=3600){if(!wnd_is_spider()){for(var t=Date.parse(new Date)/1e3,n=localStorage.getItem("wnd_views")?JSON.parse(localStorage.getItem("wnd_views")):[],s=10,d=!0,i=0;i<n.length;i++)if(n[i].post_id==a){if(n[i].timestamp<t-e){n[i].timestamp=t;d=!0}else d=!1;break}if(d){var r={post_id:a,timestamp:t};n.unshift(r)}n.length>s&&(n.length=s),d&&$.ajax({type:"GET",datatype:"json",url:wnd_rest_api,data:{param:a,action:"wnd_safe_action",method:"update_views",_ajax_nonce:wnd.ajax_nonce},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce)},success:function(a){1===a.status&&localStorage.setItem("wnd_views",JSON.stringify(n))}})}}var send_countdown,ajax_alert_time_out,ajax_msg_time_out,$=jQuery.noConflict(),lang=wnd_get_query_param("lang"),wnd_interface_api=wnd.root_url+wnd.interface_api+(lang?"?lang="+lang:""),wnd_rest_api=wnd.root_url+wnd.rest_api+(lang?"?lang="+lang:""),wnd_filter_api=wnd.root_url+wnd.filter_api+(lang?"?lang="+lang:""),wait=90;jQuery(document).ready(function(a){a("body").on("change","[type='file']",function(){if("ajax"==a(this).data("method")){var e=a(this).data("id"),t=new FormData,n=a(this).val().split("\\").pop();n=n.substring(0,n.lastIndexOf("."));for(var s=0;s<a(this).get(0).files.length;++s)t.set("wnd_file["+s+"]",a(this).prop("files")[s]);for(key in a(this).data())t.set(key,a(this).data(key));var d=a(this).data("meta_key"),i=a(this).data("is_image"),r=a(this).data("thumbnail_width"),o=a(this).data("thumbnail_height");t.set("_ajax_nonce",a(this).data("upload_nonce")),t.set("action","wnd_upload_file");var l=a(this);a.ajax({url:wnd_rest_api,dataType:"json",cache:!1,contentType:!1,processData:!1,data:t,type:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce),wnd_ajax_msg(wnd.msg.waiting,"is-warning","#"+e)},success:function(t){if(l.val(""),0===t.status)return wnd_ajax_msg(t.msg,"is-danger","#"+e),!1;for(var s=0,c=t.length;s<c;s++)if(0!==t[s].status){if(wnd_ajax_msg(wnd.msg.upload_successfully,"is-success","#"+e),"gallery"==d){a("#"+e+" .gallery .default-message").remove();var _='<div class="column is-narrow attachment-'+t[s].data.id+'"><a><img class="thumbnail" src="'+t[s].data.thumbnail+'" data-url="'+t[s].data.url+'" width="'+r+'" width="'+o+'"></a><a class="delete" data-id="'+e+'" data-file_id="'+t[s].data.id+'"></a></div>';a("#"+e+" .gallery").prepend(_)}else 1==i?(a("#"+e+" .thumbnail").prop("src",t[s].data.thumbnail),a("#"+e+" .delete").data("file_id",t[s].data.id)):(a("#"+e+" .file-name").html(wnd.msg.upload_successfully+'&nbsp<a href="'+t[s].data.url+'" target="_blank">'+wnd.msg.view+"</a>"),a("#"+e+" .delete").data("file_id",t[s].data.id));var m=l.parents("form");m.length>0&&"attachment"==m.find("input[name='_post_post_type']").val()&&(m.find("input[name='_post_ID']").val(t[s].data.id),m.find("input[name='_post_post_title']").val()||m.find("input[name='_post_post_title']").val(n),m.find("input[name='_post_post_name']").val()||m.find("input[name='_post_post_name']").val(t[s].data.post.post_name),m.find("input[name='_post_menu_order']").val()||m.find("input[name='_post_menu_order']").val(t[s].data.post.menu_order),l.prop("disabled",!0),wnd_ajax_msg(wnd.msg.upload_successfully,"is-success","#"+e),wnd_ajax_submit(m.attr("id")))}else wnd_ajax_msg(t[s].msg,"is-danger","#"+e)},error:function(){wnd_ajax_msg(wnd.msg.system_error,"is-danger","#"+e)}})}}),a("body").on("click",".upload-field .delete",function(){if(!confirm(wnd.msg.confirm))return!1;var e=a(this).data("id"),t=a(this).data("file_id");if(!t)return wnd_ajax_msg(wnd.msg.system_error,"is-danger","#"+e),!1;var n=new FormData;for(key in n.set("file_id",t),file_data=a("#"+e+" [type='file']").data(),file_data)n.set(key,file_data[key]);var s=file_data.meta_key,d=file_data.is_image,i=file_data.thumbnail;n.set("_ajax_nonce",file_data.delete_nonce),n.set("action","wnd_delete_file"),a.ajax({url:wnd_rest_api,dataType:"json",cache:!1,contentType:!1,processData:!1,data:n,type:"post",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce),wnd_ajax_msg(wnd.msg.waiting,"is-warning","#"+e)},success:function(n){if(0===n.status)return wnd_ajax_msg(n.msg,"is-danger","#"+e),!1;wnd_ajax_msg(wnd.msg.deleted,"is-success","#"+e),a("#"+e+" [type='file']").prop("disabled",!1),a(".attachment-"+t).remove(),"gallery"==s?""==a("#"+e+" .gallery").html()&&a("#"+e+" .gallery").html('<div class="column default-message"><p>'+wnd.msg.deleted+"</p></div>"):1==d?(a("#"+e+" .thumbnail").prop("src",i),a("#"+e+" .delete").data("file_id",0)):(a("#"+e+" .file-name").text(wnd.msg.deleted),a("#"+e+" .delete").data("file_id",0))},error:function(){wnd_ajax_msg(wnd.msg.system_error,"is-danger","#"+e)}})}),a("body").on("click",".send-code",function(){clearTimeout(send_countdown),wait=90;var e=a(this),t=e.parents("form").attr("id"),n=a(this).data();if(n.action="wnd_send_code",n.phone=a("#"+t+" input[name='phone']").val(),n.email=a("#"+t+" input[name='_user_user_email']").val(),""==n.email||""==n.phone)return wnd_ajax_msg(wnd.msg.required,"is-danger","#"+t),!1;a.ajax({type:"post",dataType:"json",url:wnd_rest_api,data:n,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce),e.addClass("is-loading")},success:function(a){if(a.status<=0)var n="is-danger";else{n="is-success";e.prop("disabled",!0),e.text(wnd.msg.send_successfully),wnd_send_countdown()}wnd_ajax_msg(a.msg,n,"#"+t),e.removeClass("is-loading")},error:function(){wnd_ajax_msg(wnd.msg.send_failed,"is-danger","#"+t),e.removeClass("is-loading")}})});var e=!0;a("body").on("click",".ajax-link",function(){var t=!!a(this).parents(".modal.is-active").length;if(e)if(e=!1,setTimeout(function(){e=!0},1e3),1!=a(this).data("disabled")){var n=a(this).data("is-cancel"),s=n?a(this).data("cancel"):a(this).data("action"),d=n?a(this).data("cancel-nonce"):a(this).data("action-nonce"),i=a(this);a.ajax({type:"POST",url:wnd_rest_api,data:{action:s,param:a(this).data("param"),_ajax_nonce:d},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce)},success:function(e){switch(0!=e.status&&s==i.data("action")?i.data("cancel")?i.data("is-cancel",1):i.data("disabled",1):i.data("is-cancel",0),e.status){case 1:i.html(e.data);break;case 2:e.data&&i.html(e.data),t||wnd_alert_msg(e.msg,1);break;case 3:wnd_alert_msg(wnd.msg.waiting),a(window.location).prop("href",e.data.redirect_to);break;case 4:wnd_reset_modal(),window.location.reload(!0);break;default:i.html(e.data),t||wnd_alert_msg(e.msg,1)}},error:function(){wnd_alert_msg(wnd.msg.system_error)}})}else wnd_alert_msg(wnd.msg.waiting,1)});var t={};a("body").on("click",".ajax-filter a",function(){var e=a(this).parents(".ajax-filter"),n=e.attr("ID").split("-")[1],s=e.data();t=Object.assign(t,s);var d=a(this).parents(".pagination-list").length>0;d||delete t.page;var i=a(this).data("key"),r=a(this).data("value");if(t[i]=r,r||void 0===t[i]||delete t[i],"type"==i?(t=JSON.parse(JSON.stringify(s)),t.type=a(this).data("value"),e.find("ul.tab li").removeClass("is-active"),e.find("ul.tab li:first-child").addClass("is-active")):t.type=a("#tabs-"+n).find(".post-type-tabs .is-active a").data("value"),"_term_category"==i){var o="_term_post_tag";delete t[o]}else if(i.indexOf("_cat")>0){o=i.replace("_cat","_tag");delete t[o]}var l=a(this);return a.ajax({url:wnd_filter_api,type:"GET",data:t,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wnd.rest_nonce)},success:function(n){if("type"==i){e.find(".taxonomy-tabs").addClass("is-hidden");for(var s=0;s<n.data.taxonomies.length;s++)e.find("."+n.data.taxonomies[s]+"-tabs").removeClass("is-hidden")}a(t.wnd_ajax_container).html(n.data.posts+n.data.pagination);var d=a(e).children(".main-category-tabs");d&&n.data.category_tabs&&0==a(e).find("."+n.data.category_taxonomy+"-tabs").length&&(d.last().after(n.data.category_tabs),d.remove());var r=a(e).children(".related-tags");for(taxonomy in r&&n.data.related_tags_tabs?(r.after(n.data.related_tags_tabs),r.remove()):r.addClass("is-hidden"),a(e).children(".sub-tabs").remove(),n.data.sub_taxonomy_tabs)a(e).children("."+taxonomy+"-tabs:last").after(n.data.sub_taxonomy_tabs[taxonomy])},error:function(){wnd_alert_msg(wnd.msg.system_error),l.parent("li").removeClass("is-active")}}),!1}),a("body").on("change","select.dynamic-sub",function(){var e=a(this).prop("name"),t=(e=e.split("_term_")[1],e=e.split("[]")[0],a(this).val()),n=a(this).data("child_level")?a(this).data("child_level"):0,s=a(this).prop("required"),d="."+e+"-child-"+(n+1),i=a(d).data("tips");-1!=t?a.ajax({type:"get",url:wnd_interface_api,data:{module:"wnd_sub_terms_select",param:{parent:t,taxonomy:e,child_level:n,required:s,tips:i}},success:function(t){a("."+e+"-child-"+(n+1)).html(t)}}):a("."+e+"-child-"+(n+1)).html('<select class="select"><option value="">--</option></select>')}),a("body").on("change","form",function(){var e=a(this).find("[type='submit']");e.prop("disabled",!1),e.text(e.data("text"))}),a("body").on("click","[type='submit'].ajax-submit",function(){var e=a(this).parents("form").attr("id");e?wnd_ajax_submit(e):wnd_alert_msg(wnd.msg.system_error,1)}),a("body").on("click",".gallery img",function(){a(this).parents(".gallery").find("img");var e='<img src="'+a(this).data("url")+'" />';wnd_alert_modal(e,!0)}),a("body").on("click","#modal .modal-background,#modal .modal-close",function(){wnd_reset_modal()})});