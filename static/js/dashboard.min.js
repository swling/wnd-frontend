const TextEditor={name:"TextEditor",props:{pre_editing:!1,modelValue:{type:String,default:""}},emits:["update:modelValue"],data(){return{editing:this.pre_editing}},mounted(){this.injectStyles()},methods:{enableEdit(){this.editing=!0,this.$nextTick((()=>{this.$refs.input.focus()}))},finishEdit(t){t.target.value&&(this.editing=!1)},onInput(t){this.$emit("update:modelValue",t.target.value)},injectStyles(){const t=document.createElement("style");t.textContent="\n.text-editor {display: flex;align-items: center;gap: 0.5rem;}\n.text-display {font-weight:800}\n.editing {flex-grow:1;}\n.underline-input {border: none;border-bottom: 1px solid #333;padding: 0.25em 0;background: transparent;width: 100%;outline: none;font-size: 1rem;}\n.underline-input:focus {border-bottom: 2px solid #3273dc;}\n",document.head.appendChild(t)}},template:'\n<div class="text-editor">\n  <div class="text-display" :class="{\'editing\':editing}">\n      <span v-show="!editing">{{ modelValue }}</span>\n      <input v-show="editing" ref="input" :value="modelValue" @input="onInput" @blur="finishEdit" @keydown.enter="finishEdit" class="underline-input" type="text"/>\n  </div>\n  <span v-show="!editing" class="icon is-clickable" @click="enableEdit">\n    <i class="fas fa-edit"></i>\n  </span>\n</div>\n'},OrderShipManager={props:{order:{type:Object,required:!0}},data:()=>({loading:!1}),computed:{localOrder:{get(){return this.order},set(t){this.$emit("update:order",t)}},express_no:{get(){return this.localOrder.props.express_no||""},set(t){this.localOrder.props.express_no=t}},isShipped(){return"shipped"===this.localOrder.status}},methods:{async shipOrder(){if(!this.express_no.trim())return void alert("请输入物流单号");if(!confirm("确认发货？"))return;this.loading=!0;const t={id:this.localOrder.ID,status:"shipped",express_no:this.express_no},e=await wnd_ajax_action("admin/wnd_update_transaction",t);this.loading=!1,e.status>0&&(this.localOrder={...this.localOrder,...t})},async undoShipping(){if(!confirm("确认撤销发货？"))return;this.loading=!0,this.express_no="";const t={id:this.localOrder.ID,status:"paid",express_no:this.express_no},e=await wnd_ajax_action("admin/wnd_update_transaction",t);this.loading=!1,e.status>0&&(this.localOrder={...this.localOrder,...t})}},template:'\n<div class="box">\n\t<p v-if="order.props.receiver">姓名：{{order.props.receiver.name}} 电话：{{order.props.receiver.phone}} 地址：{{order.props.receiver.address}}</p>\n\t<div class="field is-grouped mt-3">\n\t\t<div class="control is-expanded">\n\t\t\t<input class="input" type="text" placeholder="输入物流单号" v-model="express_no" :disabled="isShipped || loading" @keydown.enter="shipOrder">\n\t\t</div>\n\t\t<div class="control">\n\t\t\t<button class="button is-primary" @click="shipOrder" :disabled="isShipped || loading">\n\t\t\t\t<span class="icon"><i class="fas fa-truck"></i></span>\n\t\t\t\t<span v-if="!loading">发货</span>\n\t\t\t\t<span v-else>提交中...</span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="control" v-if="isShipped">\n\t\t\t<button class="button is-warning" @click="undoShipping" :disabled="loading">\n\t\t\t\t<span class="icon"><i class="fas fa-undo"></i></span>\n\t\t\t\t<span v-if="!loading">撤销发货</span>\n\t\t\t\t<span v-else>处理中...</span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>\n'};class Filter extends VueClass{parent_node=null;template="";init_param={};constructor(t){super(t),this.parent_node=document.querySelector(t).parentNode,this.init_param=Object.assign({number:20,paged:1},module_data.param)}data(){return{init_param:this.init_param,param:structuredClone(this.init_param),parent_node:this.parent_node}}created(){}components(){}computed(){}mounted(){this.query(),window.addEventListener("hashchange",this.parseHash)}beforeUnmount(){window.removeEventListener("hashchange",this.parseHash)}watch(){return{param:{handler(t,e){this.query()},deep:!0}}}updated(){this.$nextTick((()=>{funTransitionHeight(this.parent_node,trs_time)}))}parseHash(){const t=window.location.hash.slice(1),e=new URLSearchParams(t),n={};for(const[t,i]of e.entries())n[t]=i;delete n.module,this.param=Object.keys(n).length?n:this.init_param}update_filter(t,e,n=[]){const i=JSON.parse(JSON.stringify(this.param));if(e?i[t]=e:delete i[t],n&&n.forEach((t=>{delete i[t]})),"paged"!=t&&i.paged&&(i.paged="1"),JSON.stringify(i)===JSON.stringify(this.param))return this.query();wnd_update_url_hash(i,["ajax_type"])}is_active(t,e){return this.param[t]?this.param[t]==e?"is-active":"":"any"==e?"is-active":""}timeToString(t){return wnd_time_to_string(t)}async query(){}}function wnd_update_url_hash(t,e=[]){const n=new URLSearchParams(location.hash.slice(1));for(const i in t)e.length&&e.includes(i)||(null===t[i]||void 0===t[i]?n.delete(i):n.set(i,t[i]));window.location.hash=decodeURIComponent(n.toString())}function wnd_time_to_date(t){const e=new Date(1e3*t),n=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getDate().toString().padStart(2,"0"),s=e.getHours().toString().padStart(2,"0"),r=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");let o=new Date;return e.getFullYear()===o.getFullYear()?`${i}-${a} ${s}:${r}:${d}`:`${n}-${i}-${a} ${s}:${r}:${d}`}function wnd_time_to_string(t){let e=new Date(1e3*t),n=new Date,i=n-e,a=Math.floor(i/6e4),s=Math.floor(a/60);Math.floor(s/24);return e.getFullYear()===n.getFullYear()&&e.getMonth()===n.getMonth()&&e.getDate()===n.getDate()?0===s?a+" minutes ago":s<24?s+" hours ago":e.toDateString():wnd_time_to_date(t)}